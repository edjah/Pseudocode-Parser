{% extends "layout.html" %}

{% block title %}
  Index
{% endblock %}

{% block main %}
  <link rel="stylesheet" href="{{ url_for('static', filename='codemirror.css' ) }}">
  <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='monokai.css') }}">
  <script src="{{ url_for('static', filename='codemirror.js') }}"></script>
  <script src="{{ url_for('static', filename='python.js') }}"></script>
  <script>
    $("#nav-home").attr("class", "active");
  </script>
  <div class="container">

    <form id="user_input">
      <div class="input-group input-group-lg">
        <input class="form-control input-lg" type="text" id="parse-input" placeholder="Enter your pseudocode" autocomplete="off" autofocus>
        <span class="input-group-btn">
          <button class="btn btn-default btn-lg" id="parse-button">Submit</button>
        </span>
      </div>
    </form>
    <br>
    <textarea id="results" class="CodeMirror" rows="10" style="display:none">"Your code will appear here"</textarea>

  </div>

  <script src="{{ url_for('static', filename='script.js') }}"></script>
  <script>

    var editor = CodeMirror.fromTextArea(results, {
      lineNumbers: true,
      mode: "python",
      theme: "monokai",
      tabSize: 4,
      indentUnit: 4,
      readOnly: true,
    });
    $("#results").css("display:block");

    $("#user_input").on("submit", function(e) {
      e.preventDefault();
      inp = $("#parse-input").val()
      if (inp.length > 0) {
        codeHistory.push(inp);
        idx = codeHistory.length - 1;
      }

      $.ajax({
        url: "{{ url_for('parse') }}",
        data: {
          input: inp,
        },
        success: function (result) {
          $("#parse-input").val("");
          editor.getDoc().setValue(result);
        }
      });
    });
  </script>

{% endblock %}
